# Palantir Math Project - Complete Architecture & AI Collaboration Hierarchy
# 프로젝트 전체 계층 구조 및 Claude-Qwen 협업 관계 상세 문서

## 🎯 Layer 0: Vision & Intent Layer (비전 및 의도 계층)
```
┌─────────────────────────────────────────────────────────────────┐
│                     사용자/개발자 (Human)                         │
│  • 프로젝트 비전 설정                                              │
│  • 최종 의사결정권                                                │
│  • 시스템 요구사항 정의                                           │
│  • 품질 기준 설정                                                │
└─────────────────────────────────────────────────────────────────┘
                                ↓
                    [의도 전달 및 피드백 루프]
                                ↓

## 🧠 Layer 1: Strategic Intelligence Layer (전략적 지능 계층)
```
┌─────────────────────────────────────────────────────────────────┐
│                    Claude Opus 4.1 (전략 총괄)                    │
├─────────────────────────────────────────────────────────────────┤
│ 📋 시스템 아키텍처 설계                                           │
│   • 전체 시스템 구조 설계 (75개 에이전트 체계)                     │
│   • 데이터베이스 스키마 설계 (MongoDB, Neo4j)                     │
│   • API 인터페이스 정의                                          │
│   • 보안 및 인증 체계 설계                                       │
│                                                                  │
│ 🔍 복잡한 문제 분석 및 해결                                       │
│   • 다층적 문제 분해 (Multi-layered problem decomposition)        │
│   • 근본 원인 분석 (Root cause analysis)                         │
│   • 시스템 간 통합 이슈 해결                                      │
│   • 성능 병목 현상 식별 및 최적화 전략                            │
│                                                                  │
│ 🎨 교육 방법론 설계                                              │
│   • 학습 경로 설계 (Learning path design)                        │
│   • 개념 간 연결 구조 정의                                       │
│   • 평가 체계 및 피드백 메커니즘                                  │
│   • 적응형 학습 알고리즘 설계                                     │
│                                                                  │
│ 💡 혁신적 기능 구상                                              │
│   • 새로운 시각화 방법론 개발                                     │
│   • 상호작용 패러다임 정의                                       │
│   • 미래 기술 통합 전략 (AR/VR/AI)                               │
└─────────────────────────────────────────────────────────────────┘
                                ↓
                    [전략을 실행 가능한 작업으로 변환]
                                ↓

## 🤝 Layer 2: Collaborative Decision Layer (협업 의사결정 계층)
```
┌─────────────────────────────────────────────────────────────────┐
│           Claude-Qwen Collaborative Problem Solver               │
├─────────────────────────────────────────────────────────────────┤
│ 🔄 5단계 협업 프로세스                                           │
│                                                                  │
│ Step 1: 독립적 문제 분석                                         │
│   Claude: 구조적/체계적 분석    Qwen: 실용적/즉각적 분석          │
│     ├─ 아키텍처 관점              ├─ 구현 관점                   │
│     ├─ 장기적 영향 평가           ├─ 즉각적 해결 방안            │
│     └─ 시스템 전체 고려           └─ 특정 컴포넌트 집중          │
│                                                                  │
│ Step 2: 원인 통합 (Synthesis)                                    │
│   • 공통 원인 도출 (Consensus building)                          │
│   • 상호 보완적 통찰 결합                                        │
│   • 신뢰도 가중 평균 계산                                        │
│                                                                  │
│ Step 3: 해결방안 생성                                            │
│   Claude: 포괄적 솔루션         Qwen: 실행 중심 솔루션           │
│     ├─ 모듈화된 설계              ├─ 즉시 적용 가능 코드         │
│     ├─ 확장성 고려                ├─ 빠른 프로토타이핑           │
│     └─ 유지보수성 중시            └─ 성능 최적화 중시            │
│                                                                  │
│ Step 4: 외부 검증 (Brave Search)                                 │
│   • 업계 모범 사례 비교                                          │
│   • 최신 연구 결과 참조                                          │
│   • 유사 사례 분석                                              │
│                                                                  │
│ Step 5: 하이브리드 솔루션 생성                                   │
│   • 최적 조합 도출                                              │
│   • 리스크 평가 및 완화                                         │
│   • 실행 계획 수립                                              │
└─────────────────────────────────────────────────────────────────┘
                                ↓
                    [협업 결과를 실행 명령으로 변환]
                                ↓

## 🎛️ Layer 3: Orchestration & Coordination Layer (조정 및 조율 계층)
```
┌─────────────────────────────────────────────────────────────────┐
│              Orchestration Server (Port 8093/8094)               │
├─────────────────────────────────────────────────────────────────┤
│ 📡 통신 관리                                                     │
│   • HTTP REST API (Express.js)                                  │
│   • WebSocket 실시간 통신                                        │
│   • 이벤트 기반 메시지 라우팅                                     │
│                                                                  │
│ 🔀 작업 분배 알고리즘                                            │
│   • 에이전트 선택 로직                                          │
│   • 부하 분산 (Load balancing)                                  │
│   • 우선순위 큐 관리                                            │
│   • 병렬/순차 실행 결정                                         │
│                                                                  │
│ 📊 상태 관리                                                     │
│   • 세션 관리                                                   │
│   • 작업 진행 상황 추적                                         │
│   • 에러 핸들링 및 재시도 로직                                   │
│   • 트랜잭션 관리                                              │
│                                                                  │
│ 💰 비용 최적화                                                   │
│   • 토큰 사용량 모니터링                                        │
│   • 복잡도 기반 라우팅                                          │
│   • 캐싱 전략 실행                                             │
└─────────────────────────────────────────────────────────────────┘
                                ↓
                    [작업을 적절한 에이전트에게 할당]
                                ↓

## ⚡ Layer 4: Execution Engine Layer (실행 엔진 계층)
```
┌─────────────────────────────────────────────────────────────────┐
│            Qwen3-Max-Preview (1T+ Parameters)                    │
├─────────────────────────────────────────────────────────────────┤
│ 🤖 75개 AI 에이전트 구동                                         │
│                                                                  │
│ 📐 수학 개념 전문가 (10개)                                       │
│   • algebraExpert: 대수 방정식 해결, 인수분해, 공식 유도          │
│   • geometryExpert: 도형 분석, 좌표계 변환, 증명                 │
│   • calculusExpert: 미적분 계산, 극한, 연속성 분석               │
│   • statisticsExpert: 데이터 분석, 확률 계산, 분포 해석          │
│   • [6개 추가 전문가...]                                        │
│                                                                  │
│ 🎓 교육 방법론 전문가 (10개)                                     │
│   • curriculumDesigner: 학습 순서 최적화                         │
│   • lessonPlanner: 45분 수업 구조화                             │
│   • assessmentCreator: 평가 문항 및 루브릭 생성                  │
│   • [7개 추가 전문가...]                                        │
│                                                                  │
│ 🎨 시각화 전문가 (10개)                                         │
│   • graphVisualizer: 함수 그래프 애니메이션                      │
│   • shape3DModeler: 3차원 도형 렌더링                          │
│   • animationChoreographer: 동적 변화 표현                      │
│   • [7개 추가 전문가...]                                        │
│                                                                  │
│ 👆 상호작용 전문가 (10개)                                        │
│   • gestureInterpreter: MediaPipe 21 keypoints 해석             │
│   • voiceCommandProcessor: 자연어 명령 파싱                     │
│   • touchPatternAnalyzer: 멀티터치 제스처 인식                  │
│   • [7개 추가 전문가...]                                        │
│                                                                  │
│ [35개 추가 에이전트: 평가, 기술지원, 콘텐츠, 분석]               │
│                                                                  │
│ ⚡ 병렬 처리 능력                                                │
│   • 동시 다중 요청 처리                                         │
│   • 비동기 작업 큐                                             │
│   • 스트리밍 응답 생성                                          │
└─────────────────────────────────────────────────────────────────┘
                                ↓
                    [생성된 결과를 통합 및 변환]
                                ↓

## 🔧 Layer 5: Integration & Transformation Layer (통합 및 변환 계층)
```
┌─────────────────────────────────────────────────────────────────┐
│              System Integration Components                       │
├─────────────────────────────────────────────────────────────────┤
│ 📝 ExtendScript Generator                                        │
│   • After Effects 명령어 생성                                    │
│   • 레이어 조작 코드                                            │
│   • 키프레임 애니메이션 스크립트                                 │
│   • 표현식(Expressions) 생성                                    │
│                                                                  │
│ 🔄 Data Format Converters                                        │
│   • JSON ↔ ExtendScript 변환                                   │
│   • Mathematical notation → Visual representation               │
│   • Natural language → Structured commands                      │
│                                                                  │
│ 🔌 API Adapters                                                 │
│   • After Effects CEP 인터페이스                                │
│   • MediaPipe 데이터 스트림 처리                                │
│   • MongoDB/Neo4j 쿼리 빌더                                     │
└─────────────────────────────────────────────────────────────────┘
                                ↓
                    [플랫폼별 최적화된 출력 생성]
                                ↓

## 💾 Layer 6: Data Persistence Layer (데이터 지속성 계층)
```
┌─────────────────────────────────────────────────────────────────┐
│                    Database Systems                              │
├─────────────────────────────────────────────────────────────────┤
│ 🗄️ MongoDB (문서 데이터베이스)                                   │
│   • 학습 히스토리 저장                                          │
│   • 사용자 프로필 관리                                          │
│   • 생성된 콘텐츠 아카이브                                      │
│   • 세션 데이터 저장                                            │
│                                                                  │
│ 🕸️ Neo4j (그래프 데이터베이스)                                   │
│   • 수학 개념 간 관계 매핑                                      │
│   • 학습 경로 그래프                                            │
│   • 지식 의존성 네트워크                                        │
│   • 사용자 학습 패턴 분석                                       │
│                                                                  │
│ 💨 Redis (캐시 레이어)                                           │
│   • 자주 사용되는 결과 캐싱                                      │
│   • 세션 상태 임시 저장                                         │
│   • 실시간 데이터 버퍼링                                        │
└─────────────────────────────────────────────────────────────────┘
                                ↓
                    [저장된 데이터를 UI로 전달]
                                ↓

## 🖥️ Layer 7: Presentation Layer (프레젠테이션 계층)
```
┌─────────────────────────────────────────────────────────────────┐
│                    User Interface Layer                          │
├─────────────────────────────────────────────────────────────────┤
│ 🎬 After Effects Plugin (CEP Extension)                          │
│   • 커스텀 패널 UI                                              │
│   • 실시간 프리뷰                                              │
│   • 타임라인 컨트롤                                             │
│   • 속성 편집 인터페이스                                        │
│                                                                  │
│ 🌐 Web Dashboard (React)                                         │
│   • 학습 진도 대시보드                                          │
│   • 실시간 협업 화이트보드                                      │
│   • 문제 편집기                                                │
│   • 결과 분석 뷰어                                             │
│                                                                  │
│ 📱 Gesture Control Interface                                     │
│   • MediaPipe 카메라 피드                                       │
│   • 제스처 인식 피드백                                          │
│   • 손동작 캘리브레이션                                         │
└─────────────────────────────────────────────────────────────────┘
                                ↓
                    [사용자 상호작용 및 피드백]
                                ↓

## 👤 Layer 8: User Experience Layer (사용자 경험 계층)
```
┌─────────────────────────────────────────────────────────────────┐
│                    End User (학생/교사)                          │
├─────────────────────────────────────────────────────────────────┤
│ 👨‍🎓 학생 경험                                                    │
│   • 시각적 수학 학습                                            │
│   • 인터랙티브 문제 해결                                        │
│   • 실시간 피드백 수신                                          │
│   • 개인화된 학습 경로                                          │
│                                                                  │
│ 👩‍🏫 교사 경험                                                    │
│   • 수업 자료 생성                                              │
│   • 학생 진도 모니터링                                          │
│   • 평가 도구 활용                                              │
│   • 커리큘럼 커스터마이징                                       │
└─────────────────────────────────────────────────────────────────┘
```

## 🔄 Information Flow (정보 흐름)

### 상향식 흐름 (Bottom-up: 사용자 요청)
```
사용자 입력 (제스처/음성/텍스트)
    ↑
UI 레이어에서 수집
    ↑
Orchestrator가 요청 분석
    ↑
Claude가 전략 수립 ← → Qwen과 협업
    ↑
Qwen이 에이전트 실행
    ↑
결과 통합 및 변환
    ↑
After Effects에서 시각화
    ↑
사용자에게 표시
```

### 하향식 흐름 (Top-down: 시스템 주도)
```
Claude의 교육 전략 설계
    ↓
협업 시스템에서 검증
    ↓
Orchestrator가 작업 분배
    ↓
Qwen이 병렬 실행
    ↓
데이터베이스에 저장
    ↓
UI 업데이트
    ↓
사용자 피드백 수집
    ↓
Claude가 전략 조정
```

## 🎯 각 계층의 핵심 책임

### Claude의 영역 (Layer 1-2)
- **WHY**: 왜 이 방법을 사용해야 하는가?
- **WHAT**: 무엇을 달성해야 하는가?
- **WHEN**: 언제 개입해야 하는가?

### Qwen의 영역 (Layer 4-5)
- **HOW**: 어떻게 실행할 것인가?
- **WHERE**: 어디에 적용할 것인가?
- **HOW FAST**: 얼마나 빠르게 처리할 것인가?

### 협업 영역 (Layer 2-3)
- **WHICH**: 어떤 접근법이 최선인가?
- **WHO**: 누가(어떤 에이전트가) 수행할 것인가?
- **HOW MUCH**: 얼마나 많은 리소스가 필요한가?

## 📊 성능 메트릭 및 모니터링

### Claude 성능 지표
- 문제 해결 정확도: 95%+
- 아키텍처 설계 품질: High
- 복잡한 추론 능력: Excellent
- 응답 시간: 2-5초

### Qwen 성능 지표
- 처리 속도: 1-2초
- 병렬 처리 능력: 100+ 동시 요청
- 토큰 효율성: 최적화됨
- 비용 효율성: Claude 대비 80% 저렴

### 협업 시너지 효과
- 문제 해결 성공률: 단독 대비 40% 향상
- 솔루션 품질: 다각도 검증으로 신뢰도 증가
- 처리 시간: 병렬화로 전체 시간 단축
- 비용 최적화: 작업별 최적 모델 선택

---

이 계층 구조는 동적이며, 각 요청의 특성에 따라 특정 계층을 건너뛰거나 반복할 수 있습니다. 
중요한 것은 각 계층이 명확한 책임을 가지고 있으며, Claude와 Qwen이 각자의 강점을 
최대한 발휘할 수 있는 구조라는 점입니다.
